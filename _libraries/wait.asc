;; ==[ CALL Wait ]===============================================
;; waits a few.  THis is busy waiting (cant do other things while waiting)
;;
;; INPUT:
;; DE - nr of tenth's of a sec to wait. ( 1 = 0.1 sec)

Wait:

    ld a, (MSXID)       ; Lees de BIOS ID byte om te bepalen hoe snel de JIFFY teller is
    bit 7, a            ; Controleer bit 7
    jr z, Wait_60hz     ; Als bit 7 nul is -> 60Hz

    ld c, 5             ; Stel teller in op 50 voor 1 seconde (/10)
    jr Wait_Start

Wait_60hz:
    ld c, 6             ; Stel teller in op 60 voor 1 seconde (/10)

Wait_Start:
    ld b, 0             ; bc = 5 of 6
    call Multiply       ; HL = BC * DE
    ld b, h
    ld c, l

    ld de, (JIFFY)      ; Lees de START-waarde van JIFFY
WAIT_LOOP:
    ld hl, (JIFFY)      ; Lees de HUIDIGE waarde van JIFFY
    or a                ; Clear carry vlag
    sbc hl, de          ; HL = Huidig - Start (rekening houdend met 16-bit)
                        ; HL bevat nu het aantal verstreken interrupts

    sbc hl, bc          ; Trek het doel (50) af van de verstreken tijd
    jr c, WAIT_LOOP     ; Als resultaat negatief is (Carry=1), blijf wachten

    ret                 ; 1 seconde (of meer) is verstreken