;; ==[ CALL GetActionKeys ]===============================================
;; Checks and reads the action keys.
;; Action keys are:
;; bit   7    6    5    4    3       2     1    0
;;       →	  ↓	   ↑    ←  return   tab   esc space
;;
;; OUTPUT
;; - A: the above bitmap

GetActionKeys:
    di
    ld a, 8             ; scanline 8: has bit 7654XXX0 
    out ($AA), a        ; Schrijf rijnummer naar PPI poort C
    in a, ($A9)         ; Lees de 8 toetsen van poort A
    cpl
    and $F1             ; remove bit 1,2,3
    ld b, a             ; save in B

    ld a, 7             ; has return, X, X, X, tab, esc, X,X
    out ($AA), a        ; Schrijf rijnummer naar PPI poort C
    in a, ($A9)         ; Lees de 8 toetsen van poort A
    cpl
    
    ld c, a             ; save a
    and $80             ; get return
    rrca
    rrca
    rrca
    rrca
    or b                ; add to b
    ld b, a
    
    ld a, c             ; now do tab and esc
    rrca                ; schuif bit 2 en 3 naar 1 en 2
    and $06
    or b                ; en samenvoegen
    EI
    ret

; De MSX Toetsenmatrix 
; ====================
; Rij	Bit 7	Bit 6	Bit 5	Bit 4	Bit 3	Bit 2	Bit 1	Bit 0
; 0	    7	    6	    5	    4	    3	    2	    1	    0
; 1	    ;	    ]	    [	    \	    =	    -	    9	    8
; 2	    B	    A	    _	    /	    .	    ,	    `	    '
; 3	    J	    I	    H	    G	    F	    E	    D	    C
; 4	    R	    Q	    P	    O	    N	    M	    L	    K
; 5	    Z	    Y	    X	    W	    V	    U	    T	    S
; 6	    F3	    F2	    F1	    CODE	CAP	    GRAPH	CTRL	SHIFT
; 7	    RET	    SELECT	BS	    STOP	TAB	    ESC	    F5	    F4
; 8	    →	    ↓	    ↑	    ←	    DEL	    INS 	HOME	SPACE
;
; 9	    NUM 4	NUM 3	NUM 2	NUM 1	NUM 0	NUM /	NUM +	NUM *
; 10	NUM .	NUM ,	NUM -	NUM 9	NUM 8	NUM 7	NUM 6	NUM 5

  

